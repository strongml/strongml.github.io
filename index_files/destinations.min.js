(function(){
  function segmentGa(){
    return window.analytics &&
      typeof window.analytics.ready === 'function' &&
      window.analytics.Integrations &&
      typeof window.analytics.Integrations['Google Analytics'] === 'function';
  }

  var existingGa = window[window['GoogleAnalyticsObject'] || 'ga'];
  if (typeof existingGa != 'function' && !(segmentGa())){
    (function(){
      var w = window,
          d = document,
          s = 'script',
          g = 'https://www.google-analytics.com/analytics.js',
          o = 'ga',
          e = d.createElement(s),
          f = d.getElementsByTagName(s)[0];
      e.async=1;
      e.src=g;
      w['GoogleAnalyticsObject'] = o;
      w[o] = w[o] || function(){
        (w[o].q=w[o].q||[]).push(arguments)
      },
      w[o].l = 1 * new Date();
      f.parentNode.insertBefore(e,f);
    })();
  }

  function onReady(a,b,c){b=document,c='addEventListener'; b[c] ? b[c]('DOMContentLoaded',a) : window.attachEvent('onload',a)}

  var properties = [];

  function trackClearbitMappings() {
    var ga = window[window['GoogleAnalyticsObject'] || 'ga'];

    properties.forEach(function(property) {
      var trackerName = property.name + '_Clearbit';

      ga('create', property.id, 'auto', trackerName);

      for (var key in property.mapping) {
        if (key && property.mapping[key]) {
          ga(trackerName + '.set', key, property.mapping[key]);
        }
      }

      ga(trackerName+'.send',
        'event',
        'Clearbit',
        'Enriched',
        'Clearbit Enriched',
        { nonInteraction: true }
      );
    });

    var pushToDataLayer = false;
    
    if (pushToDataLayer) {
      window.dataLayer = window.dataLayer || [];

      var response = {"ip":"1.34.112.242","domain":"nycu.edu.tw","fuzzy":true,"type":"education","geoIP":{"city":"New Taipei","state":"New Taipei","stateCode":"NWT","country":"Taiwan","countryCode":"TW"},"company":{"ticker":null,"linkedin":{"handle":"company/nycu"},"timeZone":"Asia/Taipei","site":{"emailAddresses":null,"phoneNumbers":null},"crunchbase":{"handle":null},"name":"National Yang Ming Chiao Tung University","twitter":{"site":"https://t.co/QPFloabO3c","followers":"292.0","following":"0.0","bio":"The official Twitter feed of #NYCU_official â€” Leading university in the fields of semiconductor and medicine","handle":"NYCU_official","location":"Taipei and Hsinchu","avatar":"https://pbs.twimg.com/profile_images/1362997555878010881/XdC3RKUz_normal.jpg","id":"1349616058752094209"},"profane":false,"foundedYear":"2021.0","tech":null,"id":"61e703fd-2555-4572-8192-1fb8cc1dc5ab","phone":null,"tags":["Education"],"domain":"nycu.edu.tw","facebook":{"handle":null,"likes":null},"location":"No. 1001, Daxue Rd, East District, Hsinchu City, Taiwan 300","domainAliases":null,"logo":"https://logo.clearbit.com/nycu.edu.tw","geo":{"country":"Taiwan","countryCode":"TW","streetAddress":"1001 Daxue Road","subPremise":null,"lng":"120.9986143","city":null,"streetNumber":"1001","state":null,"postalCode":"300","stateCode":null,"lat":"24.7884305","streetName":"Daxue Road"},"emailProvider":false,"identifiers":{"usEin":null},"indexedAt":"2022-12-26 10:06:26 UTC","category":{"naicsCode":"61","sicCode":"82","industry":"Education Services","industryGroup":"Diversified Consumer Services","subIndustry":"Education","sector":"Consumer Discretionary"},"ultimateParent":{"domain":null},"parent":{"domain":null},"metrics":{"fiscalYearEnd":null,"alexaUsRank":null,"marketCap":null,"estimatedAnnualRevenue":"$10M-$50M","raised":null,"alexaGlobalRank":"31026.0","trafficRank":"high","employeesRange":"51-250","employees":"150.0","annualRevenue":null},"utcOffset":"8.0","description":"National Yang Ming Chiao Tung University is a public research university in Taiwan.","legalName":null,"techCategories":null,"type":"education"}};
      window.reveal = response
      window.dataLayer.push({ reveal: response });
      window.dataLayer.push({ event: "Clearbit_Loaded" });
    }
  }

  var applyToAnalytics = function() {
    var tryApply = function() {
      var ga = window[window['GoogleAnalyticsObject'] || 'ga'];
      return typeof ga === 'function';
    }
    if (tryApply()) {
      // Native support
      trackClearbitMappings();
    } else if (segmentGa()) {
      // Segment support
      analytics.ready(tryApply);
      analytics.ready(function(){
        trackClearbitMappings();
      });
    } else {
      console.error("Clearbit error: 'ga' variable not found.");
    }
  }

  if (document.readyState === "complete"
  || document.readyState === "loaded"
  || document.readyState === "interactive") {
    applyToAnalytics();
  } else {
    onReady(applyToAnalytics);
  }
}());